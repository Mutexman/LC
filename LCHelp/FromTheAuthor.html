<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
<title>FromTheAuthor.md</title>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<style type="text/css">
body{
    margin: 0 auto;
    font-family: Georgia, Palatino, serif;
    color: #444444;
    line-height: 1;
    max-width: 960px;
    padding: 5px;
}
h1, h2, h3, h4 {
    color: #111111;
    font-weight: 400;
}
h1, h2, h3, h4, h5, p {
    margin-bottom: 16px;
    padding: 0;
}
h1 {
    font-size: 28px;
}
h2 {
    font-size: 22px;
    margin: 20px 0 6px;
}
h3 {
    font-size: 21px;
}
h4 {
    font-size: 18px;
}
h5 {
    font-size: 16px;
}
a {
    color: #0099ff;
    margin: 0;
    padding: 0;
    vertical-align: baseline;
}
a:hover {
    text-decoration: none;
    color: #ff6600;
}
a:visited {
    color: purple;
}
ul, ol {
    padding: 0;
    margin: 0;
}
li {
    line-height: 24px;
    margin-left: 44px;
}
li ul, li ul {
    margin-left: 24px;
}
p, ul, ol {
    font-size: 14px;
    line-height: 20px;
    max-width: 540px;
}
pre {
    padding: 0px 24px;
    max-width: 800px;
    white-space: pre-wrap;
}
code {
    font-family: Consolas, Monaco, Andale Mono, monospace;
    line-height: 1.5;
    font-size: 13px;
}
aside {
    display: block;
    float: right;
    width: 390px;
}
blockquote {
    border-left:.5em solid #eee;
    padding: 0 2em;
    margin-left:0;
    max-width: 476px;
}
blockquote  cite {
    font-size:14px;
    line-height:20px;
    color:#bfbfbf;
}
blockquote cite:before {
    content: '\2014 \00A0';
}

blockquote p {  
    color: #666;
    max-width: 460px;
}
hr {
    width: 540px;
    text-align: left;
    margin: 0 auto 0 0;
    color: #999;
}

button,
input,
select,
textarea {
  font-size: 100%;
  margin: 0;
  vertical-align: baseline;
  *vertical-align: middle;
}
button, input {
  line-height: normal;
  *overflow: visible;
}
button::-moz-focus-inner, input::-moz-focus-inner {
  border: 0;
  padding: 0;
}
button,
input[type="button"],
input[type="reset"],
input[type="submit"] {
  cursor: pointer;
  -webkit-appearance: button;
}
input[type=checkbox], input[type=radio] {
  cursor: pointer;
}
/* override default chrome & firefox settings */
input:not([type="image"]), textarea {
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  box-sizing: content-box;
}

input[type="search"] {
  -webkit-appearance: textfield;
  -webkit-box-sizing: content-box;
  -moz-box-sizing: content-box;
  box-sizing: content-box;
}
input[type="search"]::-webkit-search-decoration {
  -webkit-appearance: none;
}
label,
input,
select,
textarea {
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  font-weight: normal;
  line-height: normal;
  margin-bottom: 18px;
}
input[type=checkbox], input[type=radio] {
  cursor: pointer;
  margin-bottom: 0;
}
input[type=text],
input[type=password],
textarea,
select {
  display: inline-block;
  width: 210px;
  padding: 4px;
  font-size: 13px;
  font-weight: normal;
  line-height: 18px;
  height: 18px;
  color: #808080;
  border: 1px solid #ccc;
  -webkit-border-radius: 3px;
  -moz-border-radius: 3px;
  border-radius: 3px;
}
select, input[type=file] {
  height: 27px;
  line-height: 27px;
}
textarea {
  height: auto;
}

/* grey out placeholders */
:-moz-placeholder {
  color: #bfbfbf;
}
::-webkit-input-placeholder {
  color: #bfbfbf;
}

input[type=text],
input[type=password],
select,
textarea {
  -webkit-transition: border linear 0.2s, box-shadow linear 0.2s;
  -moz-transition: border linear 0.2s, box-shadow linear 0.2s;
  transition: border linear 0.2s, box-shadow linear 0.2s;
  -webkit-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
  -moz-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1);
}
input[type=text]:focus, input[type=password]:focus, textarea:focus {
  outline: none;
  border-color: rgba(82, 168, 236, 0.8);
  -webkit-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6);
  -moz-box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6);
  box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6);
}

/* buttons */
button {
  display: inline-block;
  padding: 4px 14px;
  font-family: "Helvetica Neue", Helvetica, Arial, sans-serif;
  font-size: 13px;
  line-height: 18px;
  -webkit-border-radius: 4px;
  -moz-border-radius: 4px;
  border-radius: 4px;
  -webkit-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05);
  -moz-box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 1px 0 rgba(255, 255, 255, 0.2), 0 1px 2px rgba(0, 0, 0, 0.05);
  background-color: #0064cd;
  background-repeat: repeat-x;
  background-image: -khtml-gradient(linear, left top, left bottom, from(#049cdb), to(#0064cd));
  background-image: -moz-linear-gradient(top, #049cdb, #0064cd);
  background-image: -ms-linear-gradient(top, #049cdb, #0064cd);
  background-image: -webkit-gradient(linear, left top, left bottom, color-stop(0%, #049cdb), color-stop(100%, #0064cd));
  background-image: -webkit-linear-gradient(top, #049cdb, #0064cd);
  background-image: -o-linear-gradient(top, #049cdb, #0064cd);
  background-image: linear-gradient(top, #049cdb, #0064cd);
  color: #fff;
  text-shadow: 0 -1px 0 rgba(0, 0, 0, 0.25);
  border: 1px solid #004b9a;
  border-bottom-color: #003f81;
  -webkit-transition: 0.1s linear all;
  -moz-transition: 0.1s linear all;
  transition: 0.1s linear all;
  border-color: #0064cd #0064cd #003f81;
  border-color: rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.1) rgba(0, 0, 0, 0.25);
}
button:hover {
  color: #fff;
  background-position: 0 -15px;
  text-decoration: none;
}
button:active {
  -webkit-box-shadow: inset 0 3px 7px rgba(0, 0, 0, 0.15), 0 1px 2px rgba(0, 0, 0, 0.05);
  -moz-box-shadow: inset 0 3px 7px rgba(0, 0, 0, 0.15), 0 1px 2px rgba(0, 0, 0, 0.05);
  box-shadow: inset 0 3px 7px rgba(0, 0, 0, 0.15), 0 1px 2px rgba(0, 0, 0, 0.05);
}
button::-moz-focus-inner {
  padding: 0;
  border: 0;
}

/* CSS stylesheet is based on Kevin Burke's Markdown.css project (http://kevinburke.bitbucket.org/markdowncss) */
</style>
</head>
<body>
<p><img src="Error.bmp" alt="ErrorMan" title="Mutex" /></p>

<h2>Зачем все это надо</h2>

<p>Началось все с того, что просто  откровенно задолбало по тысячу раз на дню вводить пароль, для того чтобы подключиться к компьютеру пользователя по VNC. Причём надо вводить не только пароль, а еще и свой логин, что напрягает еще сильнее. Почему так сделано мне не понять. Казалось бы, если зашел на ПК в корпоративной сети под своей учётной записью, так и все программы запускаются от её имени. Так нет же. Собствено можно долго рассуждать на эту тему, но факт остаётся фактом, всю смену многократно вводить свой логин и пароль, мягко говоря не разумно. Поэтому и захотелось все это дело автоматизировать.</p>

<h2>Главное начать</h2>

<p>Изначально думалось побыстрому написать скрипт которому в качестве параметра передать IP адрес компьютера к которому надо подключиться, а логин, пароль, прокси и порт подставит скрипт и осуществит подключение. Но этого показалось мало, хотелось еще и IP адреса сохранять и хоть как то обозначить расположение этих компьютеров или принадлежность их организациям и станциям.</p>

<p>Сильно задумываться не стал я совершенно хладнокровно спёр все с RAdmin'a. Там в инструментарии было что то типо менеджера, где перечень компьютеров хранился в иерархическом дереве. Кстати в инструментарии VNC тоже есть что то похожее. Но все хранится немного в своеобразной форме. Данные для подключения для каждого компьютера храняться в *.vnc(являются текстовыми файлами) файлах. Эти файлы можно граммотно и удобно разложить по папкам. А для навигации по всему этому хозяйству, использовать либо стандартный проводник Windows, либо воспользоваться специальным менеджером (не знаю как это еще можно обозвать) от VNC. В любом случае файлы *.vnc следует ассоциировать с vnc-viewer.</p>

<p>Короче говоря благополучно слизав сбособ хранения данных о ПК был написана небольшая программа. В ней можно было хранить IP - адреса компьютеров и их имена, и раскидывать эти самые компьютеры по группам в дереве. Еще можно было оставлять комментарии к каждому компьютеру, в них я как правило писал номер ближайшего к ПК телефона. Вдруг что. Настройки VNC были жёстко вбиты в программу. Свой логин и пароль надо было вводить во время запуска программы. Также в программе было реализован поиск компьютера в справочнике по IP, ну и естественно базовые возможности манипуляциями данными в справочнике. Например добавить компьютер и удалить его. Хранились все объекты справочника в *.xml файле, по причине того что иерархические структуры хранить с использованием языка разметки очень удобно.</p>

<h2>Казалось бы и все</h2>

<p>Собственно поставленная задача была реализовано. Может не очень изящно с точки зрения архитектуры приложения, но работало. Но тут пришла идея что команд применяемым к ПК с использованием их IP достаточно много. Иногда приходится подключаться по sccm и RDP. Иногда лучше подкючаться по VNC без прокси. Ну и конечно же никуда не деться без самой популярной команды <em>ping</em>.</p>

<p>Для реализации всего выше перечисленно на вкладках со свойствами ПК были размещены коммандные кнопки которые под свои нужды мог настоить пользователь. Для этих кнопок возможно задать имя кнопки, выполняемую при её нажатии команду и параметры этой команды. Причем в параметрах можно было воспользоваться так называемыми переменными: user, password, ip. Во время выполнения командны за место этих переменных подставлялись значения. Вместо user и password подставлялись те значения которые пользователь вводил во время запуска программы. Вместо переменной ip подставляется ip адрес того компьютера который был выбран в справочнике.</p>

<p>Проще говоря из одной программы можно сразу же воспользоваться несколькими средствами удалённого доступа и выполнить несколько стандартных комманд.
Вот как-то так !!!</p>

<h2>Почему <em>Линейный специалист</em> ?</h2>

<p>Изначально устроился я как <em>Линейный специалист</em>. И в программу были вбиты все ПК, которые имеются на станциях которые я обслуживал, что кстати было очень удобно. Сейчас я работаю в смене. Но название менять не стал, ибо лень.</p>

<h2>Документация к программе не очень</h2>

<p>По образованию я разработчик, и во время получения этого самого образования, очень четко понял следующее. В результате разработки обязательно должна появиться документация, а с самим продуктом уж как получится. Программы может и не быть, а документ на неё быть обязан.
Вообщем была начата работа над созданием *.chm файла. Большая часть работы по сути проделана. Но в итоге я это дело остановил. Для себя одного писать её мне не хочется. Если использование программы не будет каким либо образом запрещено и пользователей будет достаточно, доделаю все как положено.</p>

<h2>Безопасность</h2>

<p>XML файл в котором хранится справочник, при сохранении шифруется текущей учётной записью, с помощью метода <em>File.Encrypt()</em>. Т.е. из под другой учётной записи этот файл не посмотреть. В случае если в в Настройках программы в <em>Место хранения справочника</em> выбрано <em>Все пользователи</em> то файл не шифруется.
Собственно каких то особых проблем по шифрованию нет. В исходном коде уже имеются методы шифрования xml файла симетричным алгоритмом TripleDES, только нужно ли это?</p>

<p>(R) Mutex 2012 год.</p>

</body>
</html>
<!-- This document was created with MarkdownPad, the Markdown editor for Windows (http://markdownpad.com) -->